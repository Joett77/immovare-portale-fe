<div class="container mx-auto max-w-5xl px-4 py-8 lg:py-16 lg:px-0">
  <!-- Loading indicator -->
  <div
    *ngIf="isLoading"
    class="flex justify-center my-8"
  >
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-primary"></div>
  </div>

  <!-- Error message -->
  <div
    *ngIf="error"
    class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6"
  >
    {{ error }}
  </div>

  <ng-container *ngIf="post && !isLoading">
    <!-- Tags -->
    <div class="mx-auto flex space-x-2">
      <app-tag-label
        *ngFor="let tag of post?.tags"
        [text]="tag"
      />
    </div>

    <!-- Main article title -->
    <h1 class="heading-xl font-extrabold font-montserrat text-primary-dark mt-4">
      {{ post.title }}
    </h1>

    <!-- Author and reading time -->
    <div class="text-[#3C3D3E] text-base flex gap-4 mt-4">
      <p>Di Redazione</p>
      <div class="flex gap-1 items-center">
        <svg
          class="w-[16px]"
          viewBox="0 0 24 24"
          width="24"
          height="24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <circle
            cx="12"
            cy="12"
            r="10"
          />
          <polyline points="12 6 12 12 16 14" />
        </svg>
        <span>{{ post.readingTime }} minuti</span>
      </div>
    </div>

    <!-- Main content -->
    <div class="mt-10">
      <!-- Main image -->
      <img
        [src]="post.image"
        [alt]="post.title"
        class="w-full h-auto mt-4 rounded-md"
      />

      <!-- Content and search bar -->
      <div class="justify-between items-start py-8 flex flex-col md:flex-row gap-x-4">
        <!-- Post content -->
        <div
          class="text-base text-black space-y-4 md:w-2/3"
          [innerHTML]="post.content"
        >
          <!-- Content is dynamically inserted here -->
        </div>

        <!-- Search input and social sharing -->
        <div class="w-full md:w-1/3 flex flex-col gap-y-6 px-4 mt-5 lg:mt-0">
          <div class="w-full mx-auto">
            <div class="relative">
              <div class="absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none">
                <fa-icon [icon]="faSearch" />
              </div>
              <input
                type="text"
                class="w-full text-sm pl-10 pr-4 py-2 border border-[#CBCCCD] rounded-md shadow-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 placeholder-[#3C3D3E] font-medium text-black"
                placeholder="Ricerca articoli"
              />
            </div>
          </div>

          <div class="flex flex-col md:flex-row gap-3 justify-between items-center">
            <button
              class="inline-flex gap-x-2 items-center text-[#3C3D3E hover:text-gray-900 transition-colors duration-200"
            >
              <fa-icon [icon]="faShare" />
              <span class="text-sm font-medium text-[#3C3D3E]">Condividi articolo</span>
            </button>

            <!-- Social media icons -->
            <div class="flex space-x-4 items-center">
              <a
                href="#"
                class="hover:text-black"
              >
                <fa-icon [icon]="faFacebookF" />
              </a>
              <a
                href="#"
                class="hover:text-black"
              >
                <fa-icon [icon]="faTwitter" />
              </a>
              <a
                href="#"
                class="hover:text-black"
              >
                <fa-icon [icon]="faLinkedinIn" />
              </a>
              <a
                href="#"
                class="hover:text-black"
              >
                <fa-icon [icon]="faTiktok" />
              </a>
              <a
                href="#"
                class="hover:text-black"
              >
                <fa-icon [icon]="faInstagram" />
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation (previous/next article) -->
    <div class="w-full">
      <nav
        class="border-t border-b border-[#CBCCCD] py-4 lg:py-8 flex justify-between items-center"
      >
        <!-- Previous Post Button -->
        <a
          class="text-black hover:text-gray-900 flex items-center"
          [class.cursor-pointer]="post.prevPostId"
          [class.opacity-50]="!post.prevPostId"
          [class.cursor-not-allowed]="!post.prevPostId"
          (click)="post.prevPostId && navigateToPost(post.prevPostId)"
        >
          <fa-icon
            [icon]="faArrowLeft"
            class="mr-2"
          />
          Articolo Precedente
          <!-- Show previous post title when available -->
        </a>

        <!-- Next Post Button -->
        <a
          class="text-black hover:text-gray-900 flex items-center"
          [class.cursor-pointer]="post.nextPostId"
          [class.opacity-50]="!post.nextPostId"
          [class.cursor-not-allowed]="!post.nextPostId"
          (click)="post.nextPostId && navigateToPost(post.nextPostId)"
        >
          Articolo Successivo

          <fa-icon
            [icon]="faArrowRight"
            class="ml-2"
          />
        </a>
      </nav>
    </div>

    <!-- Related items - now passing the current post ID and tags -->
    <app-related-items
      [currentPostId]="post.id || null"
      [currentPostTags]="post.tags || []"
    />
  </ng-container>
</div>

<!-- Stepper block -->
<app-stepper-block />
