import { Component, effect, inject } from '@angular/core';
import { CommonModule } from '@angular/common';
import { RouterLink, Router } from '@angular/router';
import { ButtonComponent } from '../../../../shared/atoms/button/button.component';
import { DomSanitizer, SafeHtml } from '@angular/platform-browser';
import { TicketNotificationService } from '../../../services/ticket-notification.service';

interface DashboardCard {
  icon: SafeHtml;
  title: string;
  description: string;
  count?: string;
  extraText?: string;
  link: string;
}

@Component({
  selector: 'app-dashboard-main',
  standalone: true,
  imports: [CommonModule, RouterLink, ButtonComponent],
  templateUrl: './dashboard-main.component.html',
})
export class DashboardMainComponent {
  private ticketNotificationService = inject(TicketNotificationService);
  protected unreadTicketList: string[] = [];

  constructor(
    private sanitizer: DomSanitizer,
    private router: Router
  ) {}

  private ticketEffect = effect(() => {
    this.unreadTicketList = this.ticketNotificationService.ticketsUnread$()
  })

  goToSection(link: string) {
    console.log(link);
    this.router.navigate([link]);
  }

  cards: DashboardCard[] = [
    {
      icon: this.sanitizer.bypassSecurityTrustHtml(
        `<svg width="57" height="48" viewBox="0 0 57 48" fill="none" ><path d="M0.8125 3.40625C0.8125 1.93359 1.94531 0.6875 3.53125 0.6875H8.96875C10.4414 0.6875 11.6875 1.93359 11.6875 3.40625V8.84375C11.6875 10.4297 10.4414 11.5625 8.96875 11.5625H3.53125C1.94531 11.5625 0.8125 10.4297 0.8125 8.84375V3.40625ZM2.625 3.40625V8.84375C2.625 9.41016 2.96484 9.75 3.53125 9.75H8.96875C9.42188 9.75 9.875 9.41016 9.875 8.84375V3.40625C9.875 2.95312 9.42188 2.5 8.96875 2.5H3.53125C2.96484 2.5 2.625 2.95312 2.625 3.40625ZM55.1875 5.21875C55.6406 5.21875 56.0938 5.67188 56.0938 6.125C56.0938 6.69141 55.6406 7.03125 55.1875 7.03125H18.9375C18.3711 7.03125 18.0312 6.69141 18.0312 6.125C18.0312 5.67188 18.3711 5.21875 18.9375 5.21875H55.1875ZM55.1875 23.3438C55.6406 23.3438 56.0938 23.7969 56.0938 24.25C56.0938 24.8164 55.6406 25.1562 55.1875 25.1562H18.9375C18.3711 25.1562 18.0312 24.8164 18.0312 24.25C18.0312 23.7969 18.3711 23.3438 18.9375 23.3438H55.1875ZM55.1875 41.4688C55.6406 41.4688 56.0938 41.9219 56.0938 42.375C56.0938 42.9414 55.6406 43.2812 55.1875 43.2812H18.9375C18.3711 43.2812 18.0312 42.9414 18.0312 42.375C18.0312 41.9219 18.3711 41.4688 18.9375 41.4688H55.1875ZM8.96875 18.8125C10.4414 18.8125 11.6875 20.0586 11.6875 21.5312V26.9688C11.6875 28.5547 10.4414 29.6875 8.96875 29.6875H3.53125C1.94531 29.6875 0.8125 28.5547 0.8125 26.9688V21.5312C0.8125 20.0586 1.94531 18.8125 3.53125 18.8125H8.96875ZM8.96875 20.625H3.53125C2.96484 20.625 2.625 21.0781 2.625 21.5312V26.9688C2.625 27.5352 2.96484 27.875 3.53125 27.875H8.96875C9.42188 27.875 9.875 27.5352 9.875 26.9688V21.5312C9.875 21.0781 9.42188 20.625 8.96875 20.625ZM0.8125 39.6562C0.8125 38.1836 1.94531 36.9375 3.53125 36.9375H8.96875C10.4414 36.9375 11.6875 38.1836 11.6875 39.6562V45.0938C11.6875 46.6797 10.4414 47.8125 8.96875 47.8125H3.53125C1.94531 47.8125 0.8125 46.6797 0.8125 45.0938V39.6562ZM2.625 39.6562V45.0938C2.625 45.6602 2.96484 46 3.53125 46H8.96875C9.42188 46 9.875 45.6602 9.875 45.0938V39.6562C9.875 39.2031 9.42188 38.75 8.96875 38.75H3.53125C2.96484 38.75 2.625 39.2031 2.625 39.6562Z" fill="#3C3D3E"/></svg>`
      ),
      title: 'I tuoi annunci',
      description: 'Visualizza e gestisci gli annunci che hai inserito.',
      count: '1 Annuncio',
      link: '/annunci',
    },
    {
      icon: this.sanitizer
        .bypassSecurityTrustHtml(`<svg width="59" height="59" viewBox="0 0 59 59" fill="none" >
<path d="M43.4805 17.4688C44.0469 17.4688 44.2734 17.8086 44.2734 18.375C44.2734 18.8281 43.8203 19.2812 43.3672 19.2812H16.293C15.8398 19.2812 15.5 18.8281 15.5 18.375C15.5 17.8086 15.7266 17.4688 16.293 17.4688H43.4805ZM32.6055 28.3438C33.1719 28.3438 33.5117 28.7969 33.3984 29.25C33.3984 29.7031 32.9453 30.1562 32.4922 30.1562H16.293C15.8398 30.1562 15.5 29.7031 15.5 29.25C15.5 28.6836 15.7266 28.3438 16.293 28.3438H32.6055ZM51.6367 0.25C55.7148 0.25 58.8867 3.53516 59 7.5V40.2383C59 44.2031 55.7148 47.375 51.75 47.375H35.4375L21.2773 58.0234C20.9375 58.25 20.7109 58.25 20.4844 58.25C19.6914 58.25 19.0117 57.6836 19.0117 56.5508V47.1484H8.13672C4.05859 47.1484 0.886719 43.9766 0.886719 40.0117V7.5C0.886719 3.53516 4.05859 0.25 8.13672 0.25H51.6367ZM57.0742 40.125V7.5C57.0742 4.66797 54.582 2.17578 51.6367 2.17578H8.13672C5.07812 2.17578 2.69922 4.55469 2.69922 7.5V40.125C2.69922 42.957 5.07812 45.4492 8.13672 45.4492H20.8242V55.8711L34.6445 45.4492H51.6367C54.582 45.4492 57.0742 43.0703 57.0742 40.125Z" fill="#3C3D3E"/>
</svg>
`),
      title: 'Centro messaggi',
      description: 'Visualizza le richieste ad assistenza che hai inviato.',
      count: '3 Messaggi',
      link: '/dashboard/messaggi',
    },
    {
      icon: this.sanitizer
        .bypassSecurityTrustHtml(`<svg width="58" height="59" viewBox="0 0 58 59" fill="none" >
<path d="M32.625 14.75C36.5898 14.75 39.875 18.0352 39.875 22C39.875 24.6055 38.4023 26.9844 36.1367 28.2305L28.6602 31.9688C28.207 32.3086 27.8672 32.7617 27.8672 33.3281V35.5938C27.8672 36.1602 27.4141 36.5 26.9609 36.5C26.3945 36.5 26.0547 36.1602 26.0547 35.5938V33.3281C26.0547 32.082 26.7344 30.9492 27.7539 30.3828L35.2305 26.6445C36.9297 25.7383 38.0625 23.9258 38.0625 22C38.0625 19.0547 35.5703 16.5625 32.625 16.5625H25.2617C22.3164 16.5625 19.9375 19.0547 19.9375 22V23.1328C19.9375 23.6992 19.4844 24.0391 19.0312 24.0391C18.4648 24.0391 18.125 23.6992 18.125 23.1328V22C18.125 18.0352 21.2969 14.75 25.2617 14.75H32.625ZM27.1875 40.125C28.0938 40.125 29 41.0312 29 41.9375C29 42.957 28.0938 43.75 27.1875 43.75C26.168 43.75 25.375 42.957 25.375 41.9375C25.375 41.0312 26.168 40.125 27.1875 40.125ZM29 0.25C44.9727 0.25 58 13.2773 58 29.25C58 45.3359 44.9727 58.25 29 58.25C12.9141 58.25 0 45.3359 0 29.25C0 13.2773 12.9141 0.25 29 0.25ZM29 56.4375C43.9531 56.4375 56.1875 44.3164 56.1875 29.25C56.1875 14.2969 43.9531 2.0625 29 2.0625C13.9336 2.0625 1.8125 14.2969 1.8125 29.25C1.8125 44.3164 13.9336 56.4375 29 56.4375Z" fill="#3C3D3E"/>
</svg>
`),
      title: 'Assistenza',
      description: 'Hai bisogno di aiuto? Inizia cercando la soluzione nelle FAQ.',
      extraText:
        'Se non trovi la risposta adatta contattaci, ti ricontatteremo nel pi√π breve tempo possibile.',
      link: '/dashboard/assistenza',
    },
    {
      icon: this.sanitizer
        .bypassSecurityTrustHtml(`<svg width="51" height="59" viewBox="0 0 51 59" fill="none" >
<path d="M25.375 29.25C17.332 29.25 10.875 22.793 10.875 14.75C10.875 6.82031 17.332 0.25 25.375 0.25C33.3047 0.25 39.875 6.82031 39.875 14.75C39.875 22.793 33.3047 29.25 25.375 29.25ZM25.375 2.0625C18.3516 2.0625 12.6875 7.83984 12.6875 14.75C12.6875 21.7734 18.3516 27.4375 25.375 27.4375C32.2852 27.4375 38.0625 21.7734 38.0625 14.75C38.0625 7.83984 32.2852 2.0625 25.375 2.0625ZM31.0391 34.6875C41.9141 34.6875 50.75 43.5234 50.75 54.3984C50.75 56.5508 48.9375 58.25 46.7852 58.25H3.85156C1.69922 58.25 0 56.5508 0 54.3984C0 43.5234 8.72266 34.6875 19.5977 34.6875H31.0391ZM46.7852 56.4375C47.918 56.4375 48.9375 55.5312 48.9375 54.3984C48.9375 44.543 40.8945 36.5 31.0391 36.5H19.5977C9.74219 36.5 1.8125 44.543 1.8125 54.3984C1.8125 55.5312 2.71875 56.4375 3.85156 56.4375H46.7852Z" fill="#3C3D3E"/>
</svg>
`),
      title: 'Profilo utente',
      description:
        'Visualizza e modifica le informazioni relative alla tua iscrizione ad Immovare.',
      extraText: '',
      link: '/dashboard/profilo',
    },
  ];
}
